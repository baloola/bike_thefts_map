---
layout: default
---

<div id='legend' style='display:none;'>
  <strong>Reload thefts for a new location</strong>
  <input type="text" id="thefts-location">
  <a id="searchbtn">Search</a>
</div>

</div>

<div id="map"></div>

<script>
  window.base_url = "https://bikewise.org/api/v2/locations/markers?";

  var query_url = "proximity=portland%2C%20OR&proximity_square=100";

  L.mapbox.accessToken = 'pk.eyJ1IjoiYmlrZWluZGV4IiwiYSI6Im40dGJpNE0ifQ.Bnz4uVCHtWsSiPiBWzPeDw';

  var map = L.mapbox.map('map', 'bikeindex.lo8d0cfk', {
    zoomControl: false
  }).setView([45.2241,-122.1446], 10);
  var hash = new L.Hash(map);
  // map.legendControl.addLegend(document.getElementById('legend').innerHTML);

  var featureLayer = L.mapbox.featureLayer().loadURL(window.base_url + query_url).addTo(map);

  $(window).on('hashchange', function(e) {
    var l = e.originalEvent.newURL.split('/');
    var lng = l.pop();
    var lat = l.pop();
    var urld = window.base_url + "proximity=" + lat + "," + lng;
    var featureLayer = L.mapbox.featureLayer().loadURL(urld).addTo(map);
  });

  

</script>